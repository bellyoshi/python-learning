# 給与明細PDF作成プログラム

このプログラムは、Excelファイルから給与データを読み取り、給与明細をPDF形式で作成するPythonアプリケーションです。

## 機能

- Excelファイルから給与データを読み込み
- 従業員別・月別の給与明細PDFを生成
- 日本語フォント対応
- 一括処理機能
- 美しいレイアウトのPDF出力

## 必要なライブラリ

```bash
pip install -r requirements.txt
```

### 依存ライブラリ
- `openpyxl`: Excelファイル読み込み
- `reportlab`: PDF生成
- `Pillow`: 画像処理

## ファイル構成

```
kyuyopdf/
├── excel_reader.py          # Excelファイル内容確認ツール
├── salary_pdf_generator.py  # 給与明細PDF生成メインプログラム
├── batch_salary_pdf.py      # 一括処理ツール
├── requirements.txt         # 依存ライブラリリスト
├── README.md               # このファイル
└── 給与支給一覧令和7年.xlsx  # サンプルExcelファイル
```

## 使用方法

### 1. Excelファイル内容確認

```bash
python excel_reader.py
```

Excelファイルの構造と内容を確認できます。

### 2. 単一の給与明細PDF作成

```bash
python salary_pdf_generator.py
```

渡邉俊行さんの1月の給与明細PDFを作成します。

### 3. 一括処理ツール

```bash
python batch_salary_pdf.py
```

対話形式で以下の選択肢から選べます：

1. **全従業員の給与明細を作成**: 全ての従業員の全月分の給与明細を作成
2. **特定の従業員の給与明細を作成**: 指定した従業員の給与明細を作成
3. **特定の月の給与明細を作成**: 指定した月の全従業員の給与明細を作成

## 出力ファイル

### 単一PDF作成
- `給与明細_渡邉俊行_1月.pdf`

### 一括処理
- `給与明細PDF/` ディレクトリ内に従業員別・月別のPDFファイルが作成されます
- 例: `給与明細_渡邉俊行_7月.pdf`

## PDFの内容

作成されるPDFには以下の情報が含まれます：

### 基本情報
- 氏名
- 社員番号
- 生年月日
- 支給年月
- 支給日

### 給与詳細
- 総支給額
- 標準報酬月額
- 健康保険
- 厚生年金
- 社会保険料控除後
- 源泉所得税
- 差引支給額
- 振込金額

### 控除内訳
- 健康保険料（従業員）
- 厚生年金（従業員）
- 社会保険料控除額
- 扶養親族等の数

## 対応データ形式

### Excelファイル要件
- シート名: `給与データ` (給与情報)
- シート名: `個人データ` (従業員基本情報)
- 必須列:
  - 支給日 (A列)
  - 氏名 (B列)
  - 総支給額 (C列)
  - その他の給与項目

## カスタマイズ

### フォント設定
Windows環境では自動的に日本語フォント（MS Gothic）が使用されます。
他の環境では `salary_pdf_generator.py` の `FONT_NAME` を変更してください。

### レイアウト変更
`salary_pdf_generator.py` の `create_payslip_pdf` メソッド内でレイアウトを調整できます。

## トラブルシューティング

### よくある問題

1. **フォントエラー**
   - Windows標準フォントが利用できない場合は、フォントパスを確認してください

2. **Excelファイル読み込みエラー**
   - ファイルパスが正しいか確認
   - ファイルが破損していないか確認

3. **PDF作成エラー**
   - 出力ディレクトリの書き込み権限を確認
   - 十分なディスク容量があるか確認

## ライセンス

このプログラムは教育目的で作成されています。

## 更新履歴

- v1.0: 初期バージョン
  - Excelファイル読み込み機能
  - 給与明細PDF生成機能
  - 一括処理機能 